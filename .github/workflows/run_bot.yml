name: ðŸ•˜ 9:00 AM IST Market Analysis

on:
  schedule:
    # 9:00 AM IST = 03:30 UTC
    - cron: "30 3 * * *"
  
  workflow_dispatch:

jobs:
  analysis:
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ•’ Show Current Time
        run: |
          echo "=== UTC NOW ==="
          date -u
          echo "=== IST NOW ==="
          TZ='Asia/Kolkata' date
          echo "Triggered at (IST): $(TZ='Asia/Kolkata' date '+%Y-%m-%d %H:%M:%S')"
      
      - name: Checkout
        uses: actions/checkout@v3
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"
      
      - name: Install Dependencies
        run: |
          pip install --upgrade pip
          pip install yfinance pandas numpy pytz requests
      
      - name: Run Algorithm
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
        run: |
          echo "ðŸš€ Running 9:00 AM IST analysis..."
          python ultimate_algo.py
      
      - name: Done
        run: |
          echo "Completed at IST: $(TZ='Asia/Kolkata' date '+%H:%M:%S')"
          echo "Date: $(TZ='Asia/Kolkata' date '+%d-%m-%Y')"
